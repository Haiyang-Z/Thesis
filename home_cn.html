<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="utf-8">
    <title>爱尔兰旅游连接</title>
    <meta name="description" content="找到你的新伙伴">
    <meta name="author" content="Haiyang Zheng">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>
    <div class="wrap-body">
        <header>
            <div class="nav-bar">
                <div class="wrap-nav zerogrid">
                    <div class="row">
                        <div class="col-1-3">
                            <div class="wrap-col">
                                <div class="logo"><a href="#"><img src="images/logo.png" /></a></div>
                            </div>
                        </div>
                        <div class="col-2-3">
                            <div class="wrap-col f-right">
                                <div id="menu">
                                    <nav>
                                        <ul>
                                            <li class="active"><a href="home_cn.html">首页</a></li>
                                            <li><a href="map_cn.html">地图</a></li>
                                            <!-- <li><a href="contact_cn.html">联系我们</a></li> -->
                                            <!-- Language Switch -->
                                            <li><a href="home_en.html"><img src="images/translation.png"
                                                        alt="中文翻译成英文"></a></li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="wrap-header">
                <h1>发现爱尔兰</h1>
                <span>与新的中国同伴一起旅行！</span>
                <center>
                    <div class="match-button">
                        <button onclick="match()">开始新的旅程</button>
                    </div>
                </center>
                <!-- !!!!!!!!!!!!时间部件!!!!!!!!!!!! -->
                <div id="time-widget" class="time-widget">
                    <h3>当前时间</h3>
                    <p id="ireland-time">爱尔兰时间: 加载中...</p>
                    <p id="china-time">中国时间: 加载中...</p>
                </div>

            </div>


            <!--////////////////////////////////////轮播图的js-->
            <script>
                document.addEventListener("DOMContentLoaded", function () {
                    const header = document.querySelector('header');
                    const images = ['../images/1.jpg', '../images/2.jpg', '../images/3.jpg', '../images/4.jpg', '../images/5.jpg', '../images/6.jpg', '../images/7.jpg'];
                    let currentIndex = 0;
        
                    function changeBackgroundImage() {
                        currentIndex = (currentIndex + 1) % images.length; // loop
                        header.style.backgroundImage = `url('${images[currentIndex]}')`;
                    }
        
                    setInterval(changeBackgroundImage, 5000);
                });
            </script>
        </header>

        <!-- Container -->
        <section id="container">
            <div class="wrap-container">
                <!-- content-box-1 -->
                <section class="content-box boxstyle-1 box-1">
                    <div class="zerogrid">
                        <div class="row wrap-box" id="content-box-1"><!--Start Box-->
                            <!-- Dynamic content will be inserted here -->
                        </div>
                    </div>
                </section>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <div class="zerogrid">
                <div class="wrap-footer row">
                    <!-- 公司信息 -->
                    <div class="col-1-3">
                        <p>Mardyke Hall, Mardyke Walk, 科克, 爱尔兰</p>
                        <p>电子邮箱: 123104052@umail.ucc.ie</p>
                        <p>电话: +353 87 7050685</p>
                    </div>
                    <!-- 快速链接 -->
                    <div class="col-1-3 quick-links">
                        <h3>快速链接</h3>
                        <ul>
                            <li><a href="home_cn.html">首页</a></li>
                            <li><a href="map_cn.html">地图</a></li>
                        </ul>
                    </div>
                    <!-- 最新资讯 -->
                    <div class="col-1-3 latest-news">
                        <h3>最新资讯</h3>
                        <ul>
                            <li><a href="https://www.ireland.ie/en/china/beijing/services/visas/check-if-you-need-a-visa/">中国游客签证要求</a></li>
                            <li><a href="https://www.citizensinformation.ie/en/travel-and-recreation/travel-to-ireland/customs-regulations-for-travellers/">爱尔兰海关规定</a></li>
                            <li><a href="https://www.ireland.ie/en/dfa/overseas-travel/know-before-you-go/safety-and-security/">健康与安全指南</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>
        
    </div>


    <!-- ！！！！！！！！！！！弹窗容器！！！！！！！！！！！！！！！！！！！！！！！！！！！！ -->
    <!-- 弹窗容器 -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modal-title"></h2>
            <button id="prevBtn" class="modal-nav-button">&#10094;</button> <!-- 左侧按钮 -->
            <img id="modal-image" src="" alt="图片">
            <button id="nextBtn" class="modal-nav-button">&#10095;</button> <!-- 右侧按钮 -->
            <p id="modal-description"></p>
        </div>
    </div>


    <!-- !!!!!!!!!!!!Weather Widget!!!!!!!!!!!! -->
    <div id="weather-toggle" class="weather-toggle">
        <button id="weather-btn" class="weather-btn">快速天气</button>
    </div>

    <div id="weather-widget" class="weather-widget hidden">
        <div class="weather-header">
            <h3></h3>
            <button id="close-weather" class="close-weather">&times;</button>
        </div>
        <div id="weather-info">加载天气数据中...</div>
    </div>



    <!-- 汇率转换小部件 -->
    <div id="exchange-widget-toggle" class="exchange-widget-toggle">
        <button id="exchange-btn" class="exchange-btn">简易转换器</button>
    </div>

    <div id="exchange-widget" class="exchange-widget hidden">
        <div class="exchange-header">
            <h3>货币转换器</h3>
            <button id="close-exchange" class="close-exchange">&times;</button>
        </div>
        <div class="exchange-content">
            <label for="currency-input">输入金额：</label>
            <input type="number" id="currency-input" placeholder="金额">
            <select id="currency-type">
                <option value="CNY">人民币到欧元</option>
                <option value="EUR">欧元到人民币</option>
            </select>
            <button id="convert-btn">转换</button>
            <p id="conversion-result"></p>
        </div>
    </div>

    
    <!-- Script to load JSON and generate content -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let currentIndex = 0;
            let data = [];

            fetch('json/data.json')
                .then(response => response.json())
                .then(jsonData => {
                    data = jsonData;
                    const container = document.getElementById('content-box-1');
                    const urlParams = new URLSearchParams(window.location.search);
                    const highlight = urlParams.get('highlight');
                    let highlightedElement = null;

                    data.forEach((item, index) => {
                        const div = document.createElement('div');
                        div.className = 'col-1-3';
                        div.innerHTML = `
                            <div class="wrap-col">
                                <div class="post" id="post-${index}">
                                    <img class="post-img" src="${item.img}" alt="${item.title.cn}">
                                    <h3 class="post-title">${item.title.cn}</h3>
                                    <div class="upload">
                                        <p>评分: ${item.stars} (${item.rating}/5)</p>
                                        <p>位置: <a href="map_cn.html?coordinates=${item.coordinates[0]},${item.coordinates[1]}">在地图上查看</a></p>
                                        <p>开放时间: ${item.opening_hours.cn}</p>
                                        <p>亮点: ${item.highlights.cn}</p>
                                        <p>联系: <a href="mailto:${item.contact.cn}">${item.contact.cn}</a></p>
                                    </div>
                                </div>
                            </div>
                        `;

                        // 检查 URL 参数是否与当前标题匹配，如果匹配则标记元素
                        if (highlight === item.title.cn) {
                            highlightedElement = div; // 记录需要闪烁的元素
                        }

                        // 为每个 post 的标题和图片添加点击事件
                        const titleElement = div.querySelector('.post-title');
                        const imageElement = div.querySelector('.post-img');

                        const openModalWithItem = function () {
                            openModal(index);
                        };

                        titleElement.addEventListener('click', openModalWithItem);
                        imageElement.addEventListener('click', openModalWithItem);

                        container.appendChild(div);
                    });

                    // 如果找到了需要闪烁的元素，滚动到它的位置，并添加闪烁效果
                    if (highlightedElement) {
                        highlightedElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        flashElement(highlightedElement.querySelector('.post')); // 调用闪烁效果
                    }
                })
                .catch(error => {
                    console.error('Error loading JSON data:', error);
                });

            // 弹窗元素
            const modal = document.getElementById('modal');
            const modalImage = document.getElementById('modal-image');
            const modalTitle = document.getElementById('modal-title');
            const modalDescription = document.getElementById('modal-description');
            const closeBtn = document.getElementsByClassName('close')[0];
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            // 打开弹窗并显示指定的图片和内容
            function openModal(index) {
                currentIndex = index;
                const item = data[currentIndex];
                modal.style.display = "block";
                modalTitle.textContent = item.title.cn;
                modalImage.src = item.img;
                // 使用 marked.parse 方法将 Markdown 转换为 HTML
                modalDescription.innerHTML = marked.parse(item.details.cn || '暂无描述。');
            }

            // 关闭弹窗
            closeBtn.onclick = function () {
                modal.style.display = "none";
            }

            // 切换到上一张图片
            prevBtn.onclick = function () {
                currentIndex = (currentIndex > 0) ? currentIndex - 1 : data.length - 1;
                openModal(currentIndex);
            }

            // 切换到下一张图片
            nextBtn.onclick = function () {
                currentIndex = (currentIndex < data.length - 1) ? currentIndex + 1 : 0;
                openModal(currentIndex);
            }

            // 当用户点击弹窗外部时关闭弹窗
            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }

            // 定义闪烁效果
            function flashElement(element) {
                element.style.transition = 'opacity 1s ease'; // 控制透明度变化的持续时间为1.5秒
                element.style.opacity = '0.5'; // 首次降低透明度

                // 第一次闪烁
                setTimeout(() => {
                    element.style.opacity = '1'; // 恢复透明度
                    // 第二次闪烁
                    setTimeout(() => {
                        element.style.opacity = '0.5'; // 再次降低透明度
                        setTimeout(() => {
                            element.style.opacity = '1';
                        }, 1000);
                    }, 1000);
                }, 1000);
            }

        });

        function match() {
            window.location.href = "map_cn.html";
        }
    </script>


    <!-- !!!!!!!!!!!!!!!!!!!!!!!!time widget Script!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
    <script>
        function updateTime() {
            const irelandTimeElement = document.getElementById('ireland-time');
            const chinaTimeElement = document.getElementById('china-time');

            // 获取当前时间
            const now = new Date();

            // 转换为爱尔兰时间（全中文格式：日期和时间）
            const irelandTime = new Intl.DateTimeFormat('zh-CN', {
                timeZone: 'Europe/Dublin',
                weekday: 'long',  // 显示星期
                year: 'numeric',
                month: 'long',  // 显示完整的月份名称
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            }).format(now);

            // 转换为中国时间（全中文格式：日期和时间）
            const chinaTime = new Intl.DateTimeFormat('zh-CN', {
                timeZone: 'Asia/Shanghai',
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            }).format(now);

            // 更新 HTML 内容
            irelandTimeElement.textContent = `爱尔兰时间: ${irelandTime}`;
            chinaTimeElement.textContent = `中国时间: ${chinaTime}`;
        }

        // 每秒更新一次时间
        setInterval(updateTime, 1000);
    </script>

    <!-- !!!!!!!!!!!!!!!!!!!!!!!!weather widget Script!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
    <script>
        // 城市数据及其坐标
        const cities = [
            { name: '都柏林', latitude: 53.3498, longitude: -6.2603 },
            { name: '科克', latitude: 51.8985, longitude: -8.4756 },
            { name: '戈尔韦', latitude: 53.2707, longitude: -9.0568 },
            { name: '利默里克', latitude: 52.6638, longitude: -8.6267 },
            { name: '沃特福德', latitude: 52.2593, longitude: -7.1101 },
            { name: '基尔肯尼', latitude: 52.6541, longitude: -7.2448 }
        ];

        // 基于代码的天气描述
        const weatherConditions = {
            0: "晴天",
            1: "多云转晴",
            2: "局部多云",
            3: "阴天",
            45: "雾",
            48: "霜雾",
            51: "小毛毛雨",
            53: "中毛毛雨",
            55: "大毛毛雨",
            61: "小雨",
            63: "中雨",
            65: "大雨",
            80: "阵雨",
            95: "雷暴"
        };

        // 加载天气数据
        document.addEventListener("DOMContentLoaded", function () {
            const weatherInfo = document.getElementById('weather-info');
            weatherInfo.innerHTML = ''; // 清除内容

            // 获取每个城市的天气数据
            cities.forEach(city => {
                fetch(`https://api.open-meteo.com/v1/forecast?latitude=${city.latitude}&longitude=${city.longitude}&daily=temperature_2m_max,temperature_2m_min,weathercode&timezone=Europe/Dublin`)
                    .then(response => response.json())
                    .then(data => {
                        const weatherData = data.daily;

                        // 获取天气描述
                        const todayWeather = weatherConditions[weatherData.weathercode[0]];
                        const tomorrowWeather = weatherConditions[weatherData.weathercode[1]];

                        const cityWeather = `
                        <div class="city-weather">
                            <h4>${city.name}</h4>
                            <p>今天: 最高 ${weatherData.temperature_2m_max[0]}°C, 最低 ${weatherData.temperature_2m_min[0]}°C, ${todayWeather}</p>
                            <p>明天: 最高 ${weatherData.temperature_2m_max[1]}°C, 最低 ${weatherData.temperature_2m_min[1]}°C, ${tomorrowWeather}</p>
                        </div>
                    `;
                        weatherInfo.innerHTML += cityWeather;
                    })
                    .catch(error => {
                        console.error('获取天气数据时出错:', error);
                        weatherInfo.innerHTML += `<div class="city-weather"><h4>${city.name}</h4><p>无法加载天气数据。</p></div>`;
                    });
            });
        });

        document.addEventListener("DOMContentLoaded", function () {
            const weatherBtn = document.getElementById('weather-btn');
            const weatherWidget = document.getElementById('weather-widget');
            const closeWeatherBtn = document.getElementById('close-weather');

            // 点击按钮时显示天气小部件
            weatherBtn.addEventListener('click', function () {
                weatherWidget.classList.add('visible');
                weatherBtn.style.display = 'none'; // 隐藏按钮
            });

            // 点击关闭按钮时隐藏天气小部件
            closeWeatherBtn.addEventListener('click', function () {
                weatherWidget.classList.remove('visible');
                weatherBtn.style.display = 'block'; // 显示按钮
            });
        });
    </script>


    <!-- !!!!!!!!!!!!!!!!!!!!!!!!exchange widget Script!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const exchangeBtn = document.getElementById('exchange-btn');
            const exchangeWidget = document.getElementById('exchange-widget');
            const closeExchangeBtn = document.getElementById('close-exchange');
            const convertBtn = document.getElementById('convert-btn');
            const currencyInput = document.getElementById('currency-input');
            const conversionResult = document.getElementById('conversion-result');
            const currencyType = document.getElementById('currency-type');

            // 显示汇率转换部件
            exchangeBtn.addEventListener('click', function () {
                exchangeWidget.classList.add('visible');
                exchangeBtn.style.display = 'none';
            });

            // 隐藏汇率转换部件并清空输入
            closeExchangeBtn.addEventListener('click', function () {
                exchangeWidget.classList.remove('visible');
                exchangeBtn.style.display = 'block';
                currencyInput.value = ''; // 清空输入框
                conversionResult.textContent = '转换结果：--'; // 重置结果文本
            });

            // 汇率转换功能
            convertBtn.addEventListener('click', function () {
                const amount = parseFloat(currencyInput.value);

                // 验证输入是否为正数且不为零
                if (isNaN(amount) || amount <= 0) {
                    conversionResult.textContent = "请输入一个大于0的有效金额。";
                    return;
                }


                const exchangeRate = 7.87;
                let result;

                if (currencyType.value === "CNY") {
                    result = amount / exchangeRate;
                    conversionResult.textContent = `转换结果：${amount} 人民币 = ${result.toFixed(2)} 欧元`;
                } else {
                    result = amount * exchangeRate;
                    conversionResult.textContent = `转换结果：${amount} 欧元 = ${result.toFixed(2)} 人民币`;
                }
            });
        });
    </script>



</body>

</html>